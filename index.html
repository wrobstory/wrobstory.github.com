<!DOCTYPE html>
<html lang="en">
<head>
        <title>wrobstory.github.com</title>
        <meta charset="utf-8" />
        <link rel="stylesheet" href="./theme/css/main.css" type="text/css" />
                <link href="http://wrobstory.github.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="wrobstory.github.com Atom Feed" />
                
        <!--[if IE]>
                <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

        <!--[if lte IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="./css/ie.css"/>
                <script src="./js/IE8.js" type="text/javascript"></script><![endif]-->

        <!--[if lt IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="./css/ie6.css"/><![endif]-->

</head>

<body id="index" class="home">
<a href="https://github.com/wrobstory">
<img style="position: absolute; top: 0; right: 0; border: 0;" src="http://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png" alt="Fork me on GitHub" />
</a>
        <header id="banner" class="body">
                <h1><a href="./">wrobstory.github.com </a></h1>
                <nav><ul>
                                    <li><a href="http://wrobstory.github.com/archives.html">Archives</a></li>
                                                                                                    <li ><a href="./category/blog.html">Blog</a></li>
                                </ul></nav>
        </header><!-- /#banner -->
                
            

                            <aside id="featured" class="body">
                <article>
                    <h1 class="entry-title"><a href="./2013/04/real-world-pandas-3.html">Real world Pandas: Indexing and Plotting with the MultiIndex</a></h1> 
                    <footer class="post-info">
        <abbr class="published" title="2013-04-16T00:00:00">
                Tue 16 April 2013
        </abbr>

                <address class="vcard author">
                By <a class="url fn" href="./author/rob-story.html">Rob Story</a>
        </address>
        <p>In <a href="./category/blog.html">Blog</a>. </p>
<p>tags: <a href="./tag/python.html">python</a><a href="./tag/wind-data.html">wind data</a><a href="./tag/pandas.html">pandas</a><a href="./tag/.html"></a></p>
</footer><!-- /.post-info --><p>The MultiIndex is one of the most valuable tools in the Pandas library, particularly if you are working with data that's heavy on columns and attributes. I was going to tackle Panels as well this time (as they can complement MultiIndexing in many ways), but the next version on Pandas that is on the cusp of release is about to introduce some new indexing tools that should make accessing minor and major axes in Panels better than before. Stay tuned. </p>
<p>Again using my data from the <a href="https://github.com/wrobstory/climatic/tree/master/examples">examples</a> folder in the climatic repo. </p>
<div class="codehilite"><pre><span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">climatic</span> <span class="kn">as</span> <span class="nn">cl</span>

<span class="n">walsenburg</span> <span class="o">=</span> <span class="n">cl</span><span class="o">.</span><span class="n">MetMast</span><span class="p">()</span>
<span class="n">walsenburg</span><span class="o">.</span><span class="n">wind_import</span><span class="p">(</span><span class="s">r&#39;CO_Walsenburg_South_Data.txt&#39;</span><span class="p">,</span> 
                       <span class="n">header_row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">time_col</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> 
                       <span class="n">delimiter</span><span class="o">=</span><span class="s">&#39;</span><span class="se">\t</span><span class="s">&#39;</span><span class="p">,</span> <span class="n">smart_headers</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>


<p>Our dataframe is a little...busy: </p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span><span class="n">df</span> <span class="o">=</span> <span class="n">walsenburg</span><span class="o">.</span><span class="n">data</span>
<span class="o">&gt;&gt;&gt;</span><span class="n">df</span>
<span class="o">&lt;</span><span class="k">class</span> <span class="nc">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="s">&#39;&gt;</span>
<span class="n">DatetimeIndex</span><span class="p">:</span> <span class="mi">106140</span> <span class="n">entries</span><span class="p">,</span> <span class="mi">2010</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mo">01</span> <span class="mi">14</span><span class="p">:</span><span class="mo">00</span><span class="p">:</span><span class="mo">00</span> <span class="n">to</span> <span class="mi">2012</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mo">07</span> <span class="mi">15</span><span class="p">:</span><span class="mi">50</span><span class="p">:</span><span class="mo">00</span>
<span class="n">Data</span> <span class="n">columns</span><span class="p">:</span>
<span class="p">(</span><span class="n">WS</span> <span class="n">Mean</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">)</span>      <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WS</span> <span class="n">StdDev</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">)</span>    <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WS</span> <span class="n">Max</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">)</span>       <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WS</span> <span class="n">Min</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">)</span>       <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WS</span> <span class="n">Mean</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">)</span>      <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WS</span> <span class="n">StdDev</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">)</span>    <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WS</span> <span class="n">Max</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">)</span>       <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WS</span> <span class="n">Min</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">)</span>       <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WS</span> <span class="n">Mean</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">)</span>      <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WS</span> <span class="n">StdDev</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">)</span>    <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WS</span> <span class="n">Max</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">)</span>       <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WS</span> <span class="n">Min</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">)</span>       <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WS</span> <span class="n">Mean</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">40.0</span><span class="p">)</span>      <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WS</span> <span class="n">StdDev</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">40.0</span><span class="p">)</span>    <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WS</span> <span class="n">Max</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">40.0</span><span class="p">)</span>       <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WS</span> <span class="n">Min</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">40.0</span><span class="p">)</span>       <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WD</span> <span class="n">Mean</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">49.0</span><span class="p">)</span>      <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WD</span> <span class="n">StdDev</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">49.0</span><span class="p">)</span>    <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WD</span> <span class="n">Max</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">49.0</span><span class="p">)</span>       <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WD</span> <span class="n">Min</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">49.0</span><span class="p">)</span>       <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WD</span> <span class="n">Mean</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">38.0</span><span class="p">)</span>      <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WD</span> <span class="n">StdDev</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">38.0</span><span class="p">)</span>    <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WD</span> <span class="n">Max</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">38.0</span><span class="p">)</span>       <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WD</span> <span class="n">Min</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">38.0</span><span class="p">)</span>       <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="n">dtypes</span><span class="p">:</span> <span class="n">float64</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span> <span class="n">int64</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
</pre></div>


<p>It would be really useful to be able to index the signals for each height. Since our columns are already tuples, Pandas lets us create a MultiIndex in one line and then apply it to our dataframe: </p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span><span class="n">multi_cols</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;Signals&#39;</span><span class="p">,</span> <span class="s">&#39;Heights&#39;</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">multi_cols</span>
<span class="o">&gt;&gt;&gt;</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span>
<span class="n">MultiIndex</span>
<span class="p">[(</span><span class="n">WS</span> <span class="n">Mean</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">),</span> <span class="p">(</span><span class="n">WS</span> <span class="n">StdDev</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">),</span> <span class="p">(</span><span class="n">WS</span> <span class="n">Max</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">),</span> <span class="p">(</span><span class="n">WS</span> <span class="n">Min</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">),</span> 
 <span class="p">(</span><span class="n">WS</span> <span class="n">Mean</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">),</span> <span class="p">(</span><span class="n">WS</span> <span class="n">StdDev</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">),</span> <span class="p">(</span><span class="n">WS</span> <span class="n">Max</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">),</span> <span class="p">(</span><span class="n">WS</span> <span class="n">Min</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">),</span> 
 <span class="p">(</span><span class="n">WS</span> <span class="n">Mean</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">),</span> <span class="p">(</span><span class="n">WS</span> <span class="n">StdDev</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">),</span> <span class="p">(</span><span class="n">WS</span> <span class="n">Max</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">),</span> <span class="p">(</span><span class="n">WS</span> <span class="n">Min</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">),</span> 
 <span class="p">(</span><span class="n">WS</span> <span class="n">Mean</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">40.0</span><span class="p">),</span> <span class="p">(</span><span class="n">WS</span> <span class="n">StdDev</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">40.0</span><span class="p">),</span> <span class="p">(</span><span class="n">WS</span> <span class="n">Max</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">40.0</span><span class="p">),</span> <span class="p">(</span><span class="n">WS</span> <span class="n">Min</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">40.0</span><span class="p">),</span> 
 <span class="p">(</span><span class="n">WD</span> <span class="n">Mean</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">49.0</span><span class="p">),</span> <span class="p">(</span><span class="n">WD</span> <span class="n">StdDev</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">49.0</span><span class="p">),</span> <span class="p">(</span><span class="n">WD</span> <span class="n">Max</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">49.0</span><span class="p">),</span> <span class="p">(</span><span class="n">WD</span> <span class="n">Min</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">49.0</span><span class="p">),</span> 
 <span class="p">(</span><span class="n">WD</span> <span class="n">Mean</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">38.0</span><span class="p">),</span> <span class="p">(</span><span class="n">WD</span> <span class="n">StdDev</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">38.0</span><span class="p">),</span> <span class="p">(</span><span class="n">WD</span> <span class="n">Max</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">38.0</span><span class="p">),</span> <span class="p">(</span><span class="n">WD</span> <span class="n">Min</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">38.0</span><span class="p">)]</span>
</pre></div>


<p>Those columns still look busy- except now we can index by signal: </p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span><span class="n">df</span><span class="p">[</span><span class="s">&#39;WS Mean 1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
                        <span class="mi">50</span>
<span class="n">Date</span> <span class="o">&amp;</span> <span class="n">Time</span> <span class="n">Stamp</span>         
<span class="mi">2010</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mo">01</span> <span class="mi">14</span><span class="p">:</span><span class="mo">00</span><span class="p">:</span><span class="mo">00</span>  <span class="mf">12.05</span>
<span class="mi">2010</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mo">01</span> <span class="mi">14</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="mo">00</span>  <span class="mf">11.48</span>
<span class="mi">2010</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mo">01</span> <span class="mi">14</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mo">00</span>  <span class="mf">14.19</span>
<span class="mi">2010</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mo">01</span> <span class="mi">14</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mo">00</span>  <span class="mf">13.21</span>
<span class="mi">2010</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mo">01</span> <span class="mi">14</span><span class="p">:</span><span class="mi">40</span><span class="p">:</span><span class="mo">00</span>  <span class="mf">11.92</span>
</pre></div>


<p>Nice! This is a little more useful, but it would be more helpful if our unique signals weren't at the top level, since the signals are grouped by height, rather than vice versa. Let's do a swap (this is why we named our levels in the previous step):</p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">swaplevel</span><span class="p">(</span><span class="s">&#39;Signals&#39;</span><span class="p">,</span> <span class="s">&#39;Heights&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>


<p>Now we can conveniently index by height: </p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span><span class="n">df</span><span class="p">[</span><span class="mf">50.0</span><span class="p">]</span>
<span class="o">&lt;</span><span class="k">class</span> <span class="nc">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="s">&#39;&gt;</span>
<span class="n">DatetimeIndex</span><span class="p">:</span> <span class="mi">106140</span> <span class="n">entries</span><span class="p">,</span> <span class="mi">2010</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mo">01</span> <span class="mi">14</span><span class="p">:</span><span class="mo">00</span><span class="p">:</span><span class="mo">00</span> <span class="n">to</span> <span class="mi">2012</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mo">07</span> <span class="mi">15</span><span class="p">:</span><span class="mi">50</span><span class="p">:</span><span class="mo">00</span>
<span class="n">Data</span> <span class="n">columns</span><span class="p">:</span>
<span class="n">WS</span> <span class="n">Mean</span> <span class="mi">1</span>      <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="n">WS</span> <span class="n">StdDev</span> <span class="mi">1</span>    <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="n">WS</span> <span class="n">Max</span> <span class="mi">1</span>       <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="n">WS</span> <span class="n">Min</span> <span class="mi">1</span>       <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="n">WS</span> <span class="n">Mean</span> <span class="mi">2</span>      <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="n">WS</span> <span class="n">StdDev</span> <span class="mi">2</span>    <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="n">WS</span> <span class="n">Max</span> <span class="mi">2</span>       <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="n">WS</span> <span class="n">Min</span> <span class="mi">2</span>       <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="n">dtypes</span><span class="p">:</span> <span class="n">float64</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
</pre></div>


<p>This is a lot more useful than having tuples for all of the columns. </p>
<p>The <a href="http://en.wikipedia.org/wiki/Wind_shear">wind shear</a> is a pretty common thing to calculate when doing wind data analysis, and for that calc we really just want mean wind speeds for each height. One option is to loop through the columns of our original dataframe and pull out the ones we need, then put the pieces back together with pd.concat: </p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span><span class="n">df</span> <span class="o">=</span> <span class="n">walsenburg</span><span class="o">.</span><span class="n">data</span> <span class="c">#Back to our original dataframe</span>
<span class="o">&gt;&gt;&gt;</span><span class="n">series_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="o">&gt;&gt;&gt;</span><span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">iterkv</span><span class="p">():</span>
       <span class="k">if</span> <span class="s">&#39;WS Mean&#39;</span> <span class="ow">in</span> <span class="n">col</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
           <span class="c">#Create array levels so that the dataframe will build a MultiIndex</span>
           <span class="n">levels</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">col</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">col</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]])]</span>
           <span class="n">temp_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">col</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="n">levels</span><span class="p">)</span>
           <span class="n">series_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp_df</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">series_list</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c">#Put the pieces together</span>
<span class="o">&gt;&gt;&gt;</span><span class="n">df2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
                            <span class="mi">50</span>                    <span class="mi">30</span>         <span class="mi">40</span>
                     <span class="n">WS</span> <span class="n">Mean</span> <span class="mi">1</span>  <span class="n">WS</span> <span class="n">Mean</span> <span class="mi">2</span>  <span class="n">WS</span> <span class="n">Mean</span> <span class="mi">3</span>  <span class="n">WS</span> <span class="n">Mean</span> <span class="mi">4</span>
<span class="n">Date</span> <span class="o">&amp;</span> <span class="n">Time</span> <span class="n">Stamp</span>                                              
<span class="mi">2010</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mo">01</span> <span class="mi">14</span><span class="p">:</span><span class="mo">00</span><span class="p">:</span><span class="mo">00</span>      <span class="mf">12.05</span>      <span class="mf">12.26</span>      <span class="mf">11.38</span>      <span class="mf">11.70</span>
<span class="mi">2010</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mo">01</span> <span class="mi">14</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="mo">00</span>      <span class="mf">11.48</span>      <span class="mf">11.60</span>      <span class="mf">10.76</span>      <span class="mf">11.14</span>
<span class="mi">2010</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mo">01</span> <span class="mi">14</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mo">00</span>      <span class="mf">14.19</span>      <span class="mf">14.39</span>      <span class="mf">13.35</span>      <span class="mf">13.84</span>
<span class="mi">2010</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mo">01</span> <span class="mi">14</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mo">00</span>      <span class="mf">13.21</span>      <span class="mf">13.43</span>      <span class="mf">12.43</span>      <span class="mf">12.94</span>
<span class="mi">2010</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mo">01</span> <span class="mi">14</span><span class="p">:</span><span class="mi">40</span><span class="p">:</span><span class="mo">00</span>      <span class="mf">11.92</span>      <span class="mf">12.12</span>      <span class="mf">11.32</span>      <span class="mf">11.60</span>
</pre></div>


<p>Very nice! What if wanted to look at all of the signals, with column levels for height, signal (WS, WD, etc), and signal attribute (Mean, Max, etc)? Just a small tweak: </p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span><span class="n">series_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="o">&gt;&gt;&gt;</span><span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">iterkv</span><span class="p">():</span>
       <span class="n">splitter</span> <span class="o">=</span> <span class="n">col</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
       <span class="n">signal</span> <span class="o">=</span> <span class="n">splitter</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
       <span class="n">att</span> <span class="o">=</span> <span class="s">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">splitter</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">splitter</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span>
       <span class="n">height</span> <span class="o">=</span> <span class="n">col</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
       <span class="n">levels</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">height</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">signal</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">att</span><span class="p">])]</span>
       <span class="n">temp_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">col</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="n">levels</span><span class="p">)</span>
       <span class="n">series_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp_df</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="n">df3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">series_list</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c">#Put the pieces together</span>
</pre></div>


<p>Now we can index with multiple keys to both height and signal: </p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span><span class="n">df3</span><span class="p">[</span><span class="mi">50</span><span class="p">][</span><span class="s">&#39;WS&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span>
                         <span class="n">Mean</span> <span class="mi">1</span>  <span class="n">StdDev</span> <span class="mi">1</span>  <span class="n">Max</span> <span class="mi">1</span>  <span class="n">Min</span> <span class="mi">1</span>  <span class="n">Mean</span> <span class="mi">2</span>  <span class="n">StdDev</span> <span class="mi">2</span>  <span class="n">Max</span> <span class="mi">2</span>  <span class="n">Min</span> <span class="mi">2</span>
<span class="n">Date</span> <span class="o">&amp;</span> <span class="n">Time</span> <span class="n">Stamp</span>                                                                  
<span class="mi">2010</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mo">01</span> <span class="mi">14</span><span class="p">:</span><span class="mo">00</span><span class="p">:</span><span class="mo">00</span>      <span class="mf">12.05</span>      <span class="mf">2.14</span>  <span class="mf">15.90</span>   <span class="mf">7.91</span>   <span class="mf">12.26</span>      <span class="mf">2.25</span>  <span class="mf">16.30</span>   <span class="mf">7.94</span>
<span class="mi">2010</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mo">01</span> <span class="mi">14</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="mo">00</span>      <span class="mf">11.48</span>      <span class="mf">2.24</span>  <span class="mf">17.40</span>   <span class="mf">6.40</span>   <span class="mf">11.60</span>      <span class="mf">2.35</span>  <span class="mf">17.47</span>   <span class="mf">6.04</span>
<span class="mi">2010</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mo">01</span> <span class="mi">14</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mo">00</span>      <span class="mf">14.19</span>      <span class="mf">2.24</span>  <span class="mf">19.30</span>   <span class="mf">9.06</span>   <span class="mf">14.39</span>      <span class="mf">2.35</span>  <span class="mf">19.37</span>   <span class="mf">9.09</span>
<span class="mi">2010</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mo">01</span> <span class="mi">14</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mo">00</span>      <span class="mf">13.21</span>      <span class="mf">1.58</span>  <span class="mf">17.40</span>   <span class="mf">9.82</span>   <span class="mf">13.43</span>      <span class="mf">1.66</span>  <span class="mf">17.84</span>   <span class="mf">9.48</span>
<span class="mi">2010</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mo">01</span> <span class="mi">14</span><span class="p">:</span><span class="mi">40</span><span class="p">:</span><span class="mo">00</span>      <span class="mf">11.92</span>      <span class="mf">1.73</span>  <span class="mf">15.48</span>   <span class="mf">7.53</span>   <span class="mf">12.12</span>      <span class="mf">1.89</span>  <span class="mf">15.96</span>   <span class="mf">7.56</span>
<span class="mi">2010</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mo">01</span> <span class="mi">14</span><span class="p">:</span><span class="mi">50</span><span class="p">:</span><span class="mo">00</span>      <span class="mf">11.90</span>      <span class="mf">1.73</span>  <span class="mf">16.24</span>   <span class="mf">7.53</span>   <span class="mf">12.05</span>      <span class="mf">1.81</span>  <span class="mf">16.30</span>   <span class="mf">7.56</span>
<span class="mi">2010</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mo">01</span> <span class="mi">15</span><span class="p">:</span><span class="mo">00</span><span class="p">:</span><span class="mo">00</span>      <span class="mf">12.78</span>      <span class="mf">1.45</span>  <span class="mf">16.63</span>   <span class="mf">9.06</span>   <span class="mf">12.92</span>      <span class="mf">1.46</span>  <span class="mf">16.70</span>   <span class="mf">8.72</span>
<span class="mi">2010</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mo">01</span> <span class="mi">15</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="mo">00</span>      <span class="mf">13.27</span>      <span class="mf">1.65</span>  <span class="mf">18.15</span>   <span class="mf">9.44</span>   <span class="mf">13.40</span>      <span class="mf">1.73</span>  <span class="mf">18.22</span>   <span class="mf">9.48</span>
<span class="mi">2010</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mo">01</span> <span class="mi">15</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mo">00</span>      <span class="mf">14.05</span>      <span class="mf">1.80</span>  <span class="mf">18.15</span>   <span class="mf">9.82</span>   <span class="mf">14.24</span>      <span class="mf">1.81</span>  <span class="mf">18.62</span>   <span class="mf">9.86</span>
<span class="mi">2010</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mo">01</span> <span class="mi">15</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mo">00</span>      <span class="mf">13.32</span>      <span class="mf">1.80</span>  <span class="mf">19.66</span>   <span class="mf">9.06</span>   <span class="mf">13.48</span>      <span class="mf">1.81</span>  <span class="mf">19.74</span>   <span class="mf">9.09</span>

<span class="o">&gt;&gt;&gt;</span><span class="n">df3</span><span class="p">[</span><span class="mi">49</span><span class="p">][</span><span class="s">&#39;WD&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
                     <span class="n">Mean</span> <span class="mi">1</span>  <span class="n">StdDev</span> <span class="mi">1</span>  <span class="n">Max</span> <span class="mi">1</span>  <span class="n">Min</span> <span class="mi">1</span>
<span class="n">Date</span> <span class="o">&amp;</span> <span class="n">Time</span> <span class="n">Stamp</span>                                  
<span class="mi">2012</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mo">07</span> <span class="mi">15</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="mo">00</span>      <span class="mi">86</span>        <span class="mi">33</span>     <span class="mi">80</span>    <span class="mi">240</span>
<span class="mi">2012</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mo">07</span> <span class="mi">15</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mo">00</span>     <span class="mi">228</span>        <span class="mi">24</span>    <span class="mi">231</span>    <span class="mi">240</span>
<span class="mi">2012</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mo">07</span> <span class="mi">15</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mo">00</span>     <span class="mi">224</span>        <span class="mi">16</span>    <span class="mi">210</span>    <span class="mi">240</span>
<span class="mi">2012</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mo">07</span> <span class="mi">15</span><span class="p">:</span><span class="mi">40</span><span class="p">:</span><span class="mo">00</span>     <span class="mi">234</span>        <span class="mi">13</span>    <span class="mi">233</span>    <span class="mi">240</span>
<span class="mi">2012</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mo">07</span> <span class="mi">15</span><span class="p">:</span><span class="mi">50</span><span class="p">:</span><span class="mo">00</span>     <span class="mi">238</span>        <span class="mi">13</span>    <span class="mi">234</span>    <span class="mi">240</span>
</pre></div>


<p>We sorted levels earlier using level names- you can actually use integer indexing as well. Lets sort for signals at the top, then height, then attributes: </p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span><span class="n">df3</span><span class="o">.</span><span class="n">reorder_levels</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="o">&lt;</span><span class="k">class</span> <span class="nc">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="s">&#39;&gt;</span>
<span class="n">DatetimeIndex</span><span class="p">:</span> <span class="mi">106140</span> <span class="n">entries</span><span class="p">,</span> <span class="mi">2010</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mo">01</span> <span class="mi">14</span><span class="p">:</span><span class="mo">00</span><span class="p">:</span><span class="mo">00</span> <span class="n">to</span> <span class="mi">2012</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mo">07</span> <span class="mi">15</span><span class="p">:</span><span class="mi">50</span><span class="p">:</span><span class="mo">00</span>
<span class="n">Data</span> <span class="n">columns</span><span class="p">:</span>
<span class="p">(</span><span class="n">WS</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">,</span> <span class="n">Mean</span> <span class="mi">1</span><span class="p">)</span>      <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WS</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">,</span> <span class="n">StdDev</span> <span class="mi">1</span><span class="p">)</span>    <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WS</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">,</span> <span class="n">Max</span> <span class="mi">1</span><span class="p">)</span>       <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WS</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">,</span> <span class="n">Min</span> <span class="mi">1</span><span class="p">)</span>       <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WS</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">,</span> <span class="n">Mean</span> <span class="mi">2</span><span class="p">)</span>      <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WS</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">,</span> <span class="n">StdDev</span> <span class="mi">2</span><span class="p">)</span>    <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WS</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">,</span> <span class="n">Max</span> <span class="mi">2</span><span class="p">)</span>       <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WS</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">,</span> <span class="n">Min</span> <span class="mi">2</span><span class="p">)</span>       <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WS</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="n">Mean</span> <span class="mi">3</span><span class="p">)</span>      <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WS</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="n">StdDev</span> <span class="mi">3</span><span class="p">)</span>    <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WS</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="n">Max</span> <span class="mi">3</span><span class="p">)</span>       <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WS</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="n">Min</span> <span class="mi">3</span><span class="p">)</span>       <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WS</span><span class="p">,</span> <span class="mf">40.0</span><span class="p">,</span> <span class="n">Mean</span> <span class="mi">4</span><span class="p">)</span>      <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WS</span><span class="p">,</span> <span class="mf">40.0</span><span class="p">,</span> <span class="n">StdDev</span> <span class="mi">4</span><span class="p">)</span>    <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WS</span><span class="p">,</span> <span class="mf">40.0</span><span class="p">,</span> <span class="n">Max</span> <span class="mi">4</span><span class="p">)</span>       <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WS</span><span class="p">,</span> <span class="mf">40.0</span><span class="p">,</span> <span class="n">Min</span> <span class="mi">4</span><span class="p">)</span>       <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WD</span><span class="p">,</span> <span class="mf">49.0</span><span class="p">,</span> <span class="n">Mean</span> <span class="mi">1</span><span class="p">)</span>      <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WD</span><span class="p">,</span> <span class="mf">49.0</span><span class="p">,</span> <span class="n">StdDev</span> <span class="mi">1</span><span class="p">)</span>    <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WD</span><span class="p">,</span> <span class="mf">49.0</span><span class="p">,</span> <span class="n">Max</span> <span class="mi">1</span><span class="p">)</span>       <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WD</span><span class="p">,</span> <span class="mf">49.0</span><span class="p">,</span> <span class="n">Min</span> <span class="mi">1</span><span class="p">)</span>       <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WD</span><span class="p">,</span> <span class="mf">38.0</span><span class="p">,</span> <span class="n">Mean</span> <span class="mi">2</span><span class="p">)</span>      <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WD</span><span class="p">,</span> <span class="mf">38.0</span><span class="p">,</span> <span class="n">StdDev</span> <span class="mi">2</span><span class="p">)</span>    <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WD</span><span class="p">,</span> <span class="mf">38.0</span><span class="p">,</span> <span class="n">Max</span> <span class="mi">2</span><span class="p">)</span>       <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WD</span><span class="p">,</span> <span class="mf">38.0</span><span class="p">,</span> <span class="n">Min</span> <span class="mi">2</span><span class="p">)</span>       <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="n">dtypes</span><span class="p">:</span> <span class="n">float64</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span> <span class="n">int64</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
</pre></div>


<p>If you are using tuples for your column or row names, I highly recommend building a MultiIndex out of them, as it allows for you to index and manipulate data very efficiently.</p>
<p>One last thing: I wrote a little library called <a href="https://github.com/wrobstory/vincent">Vincent</a> to plot data using <a href="http://trifacta.github.io/vega/">Vega</a>. Lets look at WS 1 vs WS 4 for the first ten days of data, passing our new MultiIndex to Vincent: </p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span><span class="n">data</span> <span class="o">=</span> <span class="n">df3</span><span class="p">[</span><span class="s">&#39;2010-06-01&#39;</span><span class="p">:</span><span class="s">&#39;2010-06-11&#39;</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span><span class="kn">import</span> <span class="nn">vincent</span>
<span class="o">&gt;&gt;&gt;</span><span class="n">vis</span> <span class="o">=</span> <span class="n">vincent</span><span class="o">.</span><span class="n">Scatter</span><span class="p">()</span>
<span class="c">#Pass the levels as tuples</span>
<span class="o">&gt;&gt;&gt;</span><span class="n">vis</span><span class="o">.</span><span class="n">tabular_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[(</span><span class="mi">50</span><span class="p">,</span> <span class="s">&#39;WS&#39;</span><span class="p">,</span> <span class="s">&#39;Mean 1&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="s">&#39;WS&#39;</span><span class="p">,</span> <span class="s">&#39;Mean 4&#39;</span><span class="p">)])</span>
<span class="o">&gt;&gt;&gt;</span><span class="n">vis</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="s">r&#39;/vega.json&#39;</span><span class="p">,</span> <span class="n">split_data</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">html</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>


<p><img alt="Scatter 1" src="http://farm9.staticflickr.com/8111/8660124324_676b077dbe.jpg" /></p>
<p>It's a little...bloated, for lack of a better word. Let's remove fill and make the marks smaller: </p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span><span class="n">vis</span> <span class="o">+</span> <span class="p">(</span><span class="s">&#39;transparent&#39;</span><span class="p">,</span> <span class="s">&#39;marks&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&#39;properties&#39;</span><span class="p">,</span> <span class="s">&#39;update&#39;</span><span class="p">,</span> <span class="s">&#39;fill&#39;</span><span class="p">,</span> <span class="s">&#39;value&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="n">vis</span> <span class="o">+</span> <span class="p">({</span><span class="s">&#39;value&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">},</span> <span class="s">&#39;marks&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&#39;properties&#39;</span><span class="p">,</span> <span class="s">&#39;update&#39;</span><span class="p">,</span> <span class="s">&#39;size&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="n">vis</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="s">r&#39;/vega.json&#39;</span><span class="p">,</span> <span class="n">split_data</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">html</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>


<p><img alt="Scatter 2" src="http://farm9.staticflickr.com/8121/8659022617_4698ca92ab.jpg" /></p>
<p>Better. Still need some axis labels, which is something I need to figure out how to do within Vega and make easy in Python. As always, thanks for reading!</p>                </article>
                            </aside><!-- /#featured -->
                            <section id="content" class="body">
                    <h1>Other articles</h1>
                    <hr />
                    <ol id="posts-list" class="hfeed">
                                                

                 
                        <li><article class="hentry">    
                <header>
                    <h1><a href="./2013/04/real-world-pandas-2.html" rel="bookmark"
                           title="Permalink to Real world Pandas: Cut and Where">Real world Pandas: Cut and Where</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2013-04-08T00:00:00">
                Mon 08 April 2013
        </abbr>

                <address class="vcard author">
                By <a class="url fn" href="./author/rob-story.html">Rob Story</a>
        </address>
        <p>In <a href="./category/blog.html">Blog</a>. </p>
<p>tags: <a href="./tag/python.html">python</a><a href="./tag/wind-data.html">wind data</a><a href="./tag/pandas.html">pandas</a><a href="./tag/.html"></a></p>
</footer><!-- /.post-info -->                <p>I forgot to mention in the last post why this series is called Real World Pandas. The Pandas documentation is really, really great, and the examples are exactly what I would want starting out- simple foo/bar/baz type of tables that make it simple to see what transformations are ...</p>
                <a class="readmore" href="./2013/04/real-world-pandas-2.html">read more</a>
                                </div><!-- /.entry-content -->
            </article></li>
                            

                 
                        <li><article class="hentry">    
                <header>
                    <h1><a href="./2013/04/real-world-pandas-1.html" rel="bookmark"
                           title="Permalink to Real world Pandas: Binning and Grouping">Real world Pandas: Binning and Grouping</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2013-04-03T00:00:00">
                Wed 03 April 2013
        </abbr>

                <address class="vcard author">
                By <a class="url fn" href="./author/rob-story.html">Rob Story</a>
        </address>
        <p>In <a href="./category/blog.html">Blog</a>. </p>
<p>tags: <a href="./tag/python.html">python</a><a href="./tag/wind-data.html">wind data</a><a href="./tag/pandas.html">pandas</a><a href="./tag/.html"></a></p>
</footer><!-- /.post-info -->                <p>I would have a hard time working without the <a href="http://pandas.pydata.org/">Pandas</a> library at this point. I spend a lot of time munging and anayzing tabular data, and pandas is a critical part of my workflow. I wanted to quickly demonstrate a couple small pieces of code from my side project <a href="https://github.com/wrobstory/climatic">climatic ...</a></p>
                <a class="readmore" href="./2013/04/real-world-pandas-1.html">read more</a>
                                </div><!-- /.entry-content -->
            </article></li>
                            

                 
                        <li><article class="hentry">    
                <header>
                    <h1><a href="./2013/04/getting-started.html" rel="bookmark"
                           title="Permalink to Getting Started...">Getting Started...</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2013-04-02T00:00:00">
                Tue 02 April 2013
        </abbr>

                <address class="vcard author">
                By <a class="url fn" href="./author/rob-story.html">Rob Story</a>
        </address>
        <p>In <a href="./category/blog.html">Blog</a>. </p>
<p>tags: <a href="./tag/.html"></a></p>
</footer><!-- /.post-info -->                <p>Thanks to the handy guide by <a href="http://martinbrochhaus.com/2012/02/pelican.html">Martin Brochhaus</a>, I now have a Pelican blog sitting on Github pages. So, thanks to both Martin for the guidance and Github for the hosting. </p>
<p>I'm hoping to use this blog to post snippets of Python and Javascript code as I go along ...</p>
                <a class="readmore" href="./2013/04/getting-started.html">read more</a>
                                </div><!-- /.entry-content -->
            </article></li>
                            </ol><!-- /#posts-list -->
                            <p class="paginator">
        Page 1 / 1
    </p>
                        </section><!-- /#content -->
                    <section id="extras" class="body">
                        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-39972069-1']);
    _gaq.push(['_trackPageview']);
    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>
</body>
</html>