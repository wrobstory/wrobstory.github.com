<!DOCTYPE html>
<html lang="en">
<head>
        <title>wrobstory.github.com - Blog</title>
        <meta charset="utf-8" />
        <link rel="stylesheet" href="../theme/css/main.css" type="text/css" />
                <link href="http://wrobstory.github.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="wrobstory.github.com Atom Feed" />
                
        <!--[if IE]>
                <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

        <!--[if lte IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="../css/ie.css"/>
                <script src="../js/IE8.js" type="text/javascript"></script><![endif]-->

        <!--[if lt IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="../css/ie6.css"/><![endif]-->

</head>

<body id="index" class="home">
<a href="https://github.com/wrobstory">
<img style="position: absolute; top: 0; right: 0; border: 0;" src="http://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png" alt="Fork me on GitHub" />
</a>
        <header id="banner" class="body">
                <h1><a href="../">wrobstory.github.com </a></h1>
                <nav><ul>
                                    <li><a href="http://wrobstory.github.com/archives.html">Archives</a></li>
                                                                                                    <li class="active"><a href="../category/blog.html">Blog</a></li>
                                </ul></nav>
        </header><!-- /#banner -->
                
            

                            <aside id="featured" class="body">
                <article>
                    <h1 class="entry-title"><a href="../2013/04/python-maps-chloropleth.html">Maps and Chloropleths in <10 lines of Python</a></h1> 
                    <footer class="post-info">
        <abbr class="published" title="2013-04-29T00:00:00">
                Mon 29 April 2013
        </abbr>

                <address class="vcard author">
                By <a class="url fn" href="../author/rob-story.html">Rob Story</a>
        </address>
        <p>In <a href="../category/blog.html">Blog</a>. </p>
<p>tags: <a href="../tag/python.html">python</a><a href="../tag/maps.html">maps</a><a href="../tag/vincent.html">vincent</a></p>
</footer><!-- /.post-info --><div class="codehilite"><pre><span class="kn">import</span> <span class="nn">vincent</span>
<span class="n">world_countries</span> <span class="o">=</span> <span class="s">r&#39;world-countries.json&#39;</span>
<span class="n">world</span> <span class="o">=</span> <span class="n">vincent</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">1200</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">world</span><span class="o">.</span><span class="n">geo_data</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s">&#39;winkel3&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">world</span><span class="o">=</span><span class="n">world_countries</span><span class="p">)</span>
<span class="n">world</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</pre></div>


<p><img alt="World" src="http://farm9.staticflickr.com/8394/8695267202_89da3761d7_z.jpg" />  </p>
<p>One of my goals when I started building <a href="https://github.com/wrobstory/vincent">Vincent</a> was to streamline the
creation of maps as much as possible. There are some excellent Python map libraries out there- see <a href="https://github.com/matplotlib/basemap">Basemap</a> and <a href="https://github.com/kartograph/kartograph.py">Kartograph</a> for
more fun with maps. I highly recommend both of those tools, as they are both quite good and very powerful. I 
wanted something a little simpler, that relies on the power of <a href="http://trifacta.github.io/vega/">Vega</a> and allows for simple syntax- point to geoJSON files, specify a projection and scale/size, output the map.</p>
<p>For instance, layering sets of map data in order to create more complex maps: </p>
<div class="codehilite"><pre><span class="n">vis</span> <span class="o">=</span> <span class="n">vincent</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">800</span><span class="p">)</span>
<span class="c">#Add the US county data and a new line color</span>
<span class="n">vis</span><span class="o">.</span><span class="n">geo_data</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s">&#39;albersUsa&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">counties</span><span class="o">=</span><span class="n">county_geo</span><span class="p">)</span>
<span class="n">vis</span> <span class="o">+</span> <span class="p">(</span><span class="s">&#39;2B4ECF&#39;</span><span class="p">,</span> <span class="s">&#39;marks&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&#39;properties&#39;</span><span class="p">,</span> <span class="s">&#39;enter&#39;</span><span class="p">,</span> <span class="s">&#39;stroke&#39;</span><span class="p">,</span> <span class="s">&#39;value&#39;</span><span class="p">)</span>

<span class="c">#Add the state data, remove the fill, write Vega spec output to JSON</span>
<span class="n">vis</span><span class="o">.</span><span class="n">geo_data</span><span class="p">(</span><span class="n">states</span><span class="o">=</span><span class="n">state_geo</span><span class="p">)</span>
<span class="n">vis</span> <span class="o">-</span> <span class="p">(</span><span class="s">&#39;fill&#39;</span><span class="p">,</span> <span class="s">&#39;marks&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;properties&#39;</span><span class="p">,</span> <span class="s">&#39;enter&#39;</span><span class="p">)</span>
<span class="n">vis</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</pre></div>


<p><img alt="USA Map" src="http://farm9.staticflickr.com/8389/8690908267_d7a3a83dae_z.jpg" /></p>
<p>Additionally, chloropleth maps were begging for a binding to the Pandas DataFrame, with data columns mapping directly to map features. Assuming a 1:1 mapping from geoJSON features to column data, the syntax is very straightforward: </p>
<div class="codehilite"><pre><span class="c">#&#39;merged&#39; is the Pandas DataFrame</span>
<span class="n">vis</span> <span class="o">=</span> <span class="n">vincent</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">800</span><span class="p">)</span>
<span class="n">vis</span><span class="o">.</span><span class="n">tabular_data</span><span class="p">(</span><span class="n">merged</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;FIPS_Code&#39;</span><span class="p">,</span> <span class="s">&#39;Unemployment_rate_2011&#39;</span><span class="p">])</span> 
<span class="n">vis</span><span class="o">.</span><span class="n">geo_data</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s">&#39;albersUsa&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">bind_data</span><span class="o">=</span><span class="s">&#39;data.id&#39;</span><span class="p">,</span> <span class="n">counties</span><span class="o">=</span><span class="n">county_geo</span><span class="p">)</span>
<span class="n">vis</span> <span class="o">+</span> <span class="p">([</span><span class="s">&quot;#f5f5f5&quot;</span><span class="p">,</span><span class="s">&quot;#000045&quot;</span><span class="p">],</span> <span class="s">&#39;scales&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&#39;range&#39;</span><span class="p">)</span>
<span class="n">vis</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</pre></div>


<p><img alt="Chloropleth" src="http://farm9.staticflickr.com/8543/8692026644_a1ee888398_z.jpg" /></p>
<p>This isn't without a little data wrangling and transformation- the user needs to ensure that there is a 1:1 mapping of keys in the geoJSON to row keys in the Pandas DataFrame. Here is what was required to get a clean DataFrame for mapping for the previous example: our county data is a csv with <a href="http://en.wikipedia.org/wiki/Federal_Information_Processing_Standard">FIPS</a> code, county name, and our economic data (column names withheld): </p>
<div class="codehilite"><pre><span class="mo">00000</span><span class="p">,</span><span class="n">US</span><span class="p">,</span><span class="n">United</span> <span class="n">States</span><span class="p">,</span><span class="mi">154505871</span><span class="p">,</span><span class="mi">140674478</span><span class="p">,</span><span class="mi">13831393</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">50502</span><span class="p">,</span><span class="mi">100</span>
<span class="mo">01000</span><span class="p">,</span><span class="n">AL</span><span class="p">,</span><span class="n">Alabama</span><span class="p">,</span><span class="mi">2190519</span><span class="p">,</span><span class="mi">1993977</span><span class="p">,</span><span class="mi">196542</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">41427</span><span class="p">,</span><span class="mi">100</span>
<span class="mo">01001</span><span class="p">,</span><span class="n">AL</span><span class="p">,</span><span class="n">Autauga</span> <span class="n">County</span><span class="p">,</span><span class="mi">25930</span><span class="p">,</span><span class="mi">23854</span><span class="p">,</span><span class="mi">2076</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">48863</span><span class="p">,</span><span class="mf">117.9</span>
<span class="mo">01003</span><span class="p">,</span><span class="n">AL</span><span class="p">,</span><span class="n">Baldwin</span> <span class="n">County</span><span class="p">,</span><span class="mi">85407</span><span class="p">,</span><span class="mi">78491</span><span class="p">,</span><span class="mi">6916</span><span class="p">,</span><span class="mf">8.1</span><span class="p">,</span><span class="mi">50144</span><span class="p">,</span><span class="mi">121</span>
<span class="mo">01005</span><span class="p">,</span><span class="n">AL</span><span class="p">,</span><span class="n">Barbour</span> <span class="n">County</span><span class="p">,</span><span class="mi">9761</span><span class="p">,</span><span class="mi">8651</span><span class="p">,</span><span class="mi">1110</span><span class="p">,</span><span class="mf">11.4</span><span class="p">,</span><span class="mi">30117</span><span class="p">,</span><span class="mf">72.7</span>
</pre></div>


<p>And our county polygons in a geoJSON with FIPS codes as the id's (thanks to the folks at <a href="http://trifacta.github.io/vega/">Trifacta</a> for this data). The actual polygons have been truncated here for brevity, see the <a href="https://github.com/wrobstory/vincent/tree/master/examples/data">example data</a> for the complete dataset: </p>
<div class="codehilite"><pre><span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;FeatureCollection&quot;</span><span class="p">,</span><span class="nt">&quot;features&quot;</span><span class="p">:[</span>
<span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;Feature&quot;</span><span class="p">,</span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="s2">&quot;1001&quot;</span><span class="p">,</span><span class="nt">&quot;properties&quot;</span><span class="p">:{</span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;Autauga&quot;</span><span class="p">}</span>
<span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;Feature&quot;</span><span class="p">,</span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="s2">&quot;1003&quot;</span><span class="p">,</span><span class="nt">&quot;properties&quot;</span><span class="p">:{</span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;Baldwin&quot;</span><span class="p">}</span>
<span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;Feature&quot;</span><span class="p">,</span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="s2">&quot;1005&quot;</span><span class="p">,</span><span class="nt">&quot;properties&quot;</span><span class="p">:{</span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;Barbour&quot;</span><span class="p">}</span>
<span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;Feature&quot;</span><span class="p">,</span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="s2">&quot;1007&quot;</span><span class="p">,</span><span class="nt">&quot;properties&quot;</span><span class="p">:{</span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;Bibb&quot;</span><span class="p">}</span>
<span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;Feature&quot;</span><span class="p">,</span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="s2">&quot;1009&quot;</span><span class="p">,</span><span class="nt">&quot;properties&quot;</span><span class="p">:{</span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;Blount&quot;</span><span class="p">}</span>
<span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;Feature&quot;</span><span class="p">,</span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="s2">&quot;1011&quot;</span><span class="p">,</span><span class="nt">&quot;properties&quot;</span><span class="p">:{</span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;Bullock&quot;</span><span class="p">}</span>
<span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;Feature&quot;</span><span class="p">,</span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="s2">&quot;1013&quot;</span><span class="p">,</span><span class="nt">&quot;properties&quot;</span><span class="p">:{</span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;Butler&quot;</span><span class="p">}</span>
<span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;Feature&quot;</span><span class="p">,</span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="s2">&quot;1015&quot;</span><span class="p">,</span><span class="nt">&quot;properties&quot;</span><span class="p">:{</span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;Calhoun&quot;</span><span class="p">}</span>
<span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;Feature&quot;</span><span class="p">,</span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="s2">&quot;1017&quot;</span><span class="p">,</span><span class="nt">&quot;properties&quot;</span><span class="p">:{</span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;Chambers&quot;</span><span class="p">}</span>
<span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;Feature&quot;</span><span class="p">,</span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="s2">&quot;1019&quot;</span><span class="p">,</span><span class="nt">&quot;properties&quot;</span><span class="p">:{</span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;Cherokee&quot;</span><span class="p">}</span>
</pre></div>


<p>We need to match the FIPS codes and ensure that the matches are exact, or Vega won't zip the data properly: </p>
<div class="codehilite"><pre><span class="c">#Map the county codes we have in our geometry to those in the</span>
<span class="c">#county_data file, which contains additional rows we don&#39;t need</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">county_geo</span><span class="p">,</span> <span class="s">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">get_id</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

<span class="c">#Grab the FIPS codes and load them into a dataframe</span>
<span class="n">county_codes</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="s">&#39;id&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">get_id</span><span class="p">[</span><span class="s">&#39;features&#39;</span><span class="p">]]</span>
<span class="n">county_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s">&#39;FIPS_Code&#39;</span><span class="p">:</span> <span class="n">county_codes</span><span class="p">},</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">str</span><span class="p">)</span>

<span class="c">#Read into Dataframe, cast to string for consistency</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">county_data</span><span class="p">,</span> <span class="n">na_values</span><span class="o">=</span><span class="p">[</span><span class="s">&#39; &#39;</span><span class="p">])</span>
<span class="n">df</span><span class="p">[</span><span class="s">&#39;FIPS_Code&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">&#39;FIPS_Code&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>

<span class="c">#Perform an inner join, pad NA&#39;s with data from nearest county</span>
<span class="n">merged</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">county_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s">&#39;FIPS_Code&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s">&#39;inner&#39;</span><span class="p">)</span>
<span class="n">merged</span> <span class="o">=</span> <span class="n">merged</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s">&#39;pad&#39;</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span><span class="n">merged</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
      <span class="n">FIPS_Code</span> <span class="n">State</span>       <span class="n">Area_name</span>  <span class="n">Civilian_labor_force_2011</span>  <span class="n">Employed_2011</span>  \
    <span class="mi">0</span>      <span class="mi">1001</span>    <span class="n">AL</span>  <span class="n">Autauga</span> <span class="n">County</span>                      <span class="mi">25930</span>          <span class="mi">23854</span>   
    <span class="mi">1</span>      <span class="mi">1003</span>    <span class="n">AL</span>  <span class="n">Baldwin</span> <span class="n">County</span>                      <span class="mi">85407</span>          <span class="mi">78491</span>   
    <span class="mi">2</span>      <span class="mi">1005</span>    <span class="n">AL</span>  <span class="n">Barbour</span> <span class="n">County</span>                       <span class="mi">9761</span>           <span class="mi">8651</span>   
    <span class="mi">3</span>      <span class="mi">1007</span>    <span class="n">AL</span>     <span class="n">Bibb</span> <span class="n">County</span>                       <span class="mi">9216</span>           <span class="mi">8303</span>   
    <span class="mi">4</span>      <span class="mi">1009</span>    <span class="n">AL</span>   <span class="n">Blount</span> <span class="n">County</span>                      <span class="mi">26347</span>          <span class="mi">24156</span>

   <span class="n">Unemployed_2011</span>  <span class="n">Unemployment_rate_2011</span>  <span class="n">Median_Household_Income_2011</span>  \
<span class="mi">0</span>             <span class="mi">2076</span>                     <span class="mf">8.0</span>                         <span class="mi">48863</span>   
<span class="mi">1</span>             <span class="mi">6916</span>                     <span class="mf">8.1</span>                         <span class="mi">50144</span>   
<span class="mi">2</span>             <span class="mi">1110</span>                    <span class="mf">11.4</span>                         <span class="mi">30117</span>   
<span class="mi">3</span>              <span class="mi">913</span>                     <span class="mf">9.9</span>                         <span class="mi">37347</span>   
<span class="mi">4</span>             <span class="mi">2191</span>                     <span class="mf">8.3</span>                         <span class="mi">41940</span>

   <span class="n">Med_HH_Income_Percent_of_StateTotal_2011</span>  
<span class="mi">0</span>                                     <span class="mf">117.9</span>  
<span class="mi">1</span>                                     <span class="mf">121.0</span>  
<span class="mi">2</span>                                      <span class="mf">72.7</span>  
<span class="mi">3</span>                                      <span class="mf">90.2</span>  
<span class="mi">4</span>                                     <span class="mf">101.2</span>
</pre></div>


<p>And now we can quickly generate different chloropleths: </p>
<div class="codehilite"><pre><span class="n">vis</span><span class="o">.</span><span class="n">tabular_data</span><span class="p">(</span><span class="n">merged</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;FIPS_Code&#39;</span><span class="p">,</span> <span class="s">&#39;Civilian_labor_force_2011&#39;</span><span class="p">])</span> 
<span class="n">vis</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</pre></div>


<p><img alt="Labor Force" src="http://farm9.staticflickr.com/8545/8694182969_9a6e04fe92_z.jpg" /></p>
<p>That's not telling us much other than that LA and King counties are both very large and very populous. Let's look at median household income: </p>
<div class="codehilite"><pre><span class="n">vis</span><span class="o">.</span><span class="n">tabular_data</span><span class="p">(</span><span class="n">merged</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;FIPS_Code&#39;</span><span class="p">,</span> <span class="s">&#39;Median_Household_Income_2011&#39;</span><span class="p">])</span>
<span class="n">vis</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</pre></div>


<p><img alt="Median Income" src="http://farm9.staticflickr.com/8536/8694183111_c2c80516df_z.jpg" /></p>
<p>Certainly some high income areas on the east coast and in other high density areas. I bet this would be more interesting on the city level, but that will have to wait for a future post. Lets quickly reset the map and look at state unemployment: </p>
<div class="codehilite"><pre><span class="c">#Swap county data for state data, reset map</span>
<span class="n">state_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">state_unemployment</span><span class="p">)</span>
<span class="n">vis</span><span class="o">.</span><span class="n">tabular_data</span><span class="p">(</span><span class="n">state_data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;State&#39;</span><span class="p">,</span> <span class="s">&#39;Unemployment&#39;</span><span class="p">])</span>
<span class="n">vis</span><span class="o">.</span><span class="n">geo_data</span><span class="p">(</span><span class="n">bind_data</span><span class="o">=</span><span class="s">&#39;data.id&#39;</span><span class="p">,</span> <span class="n">reset</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">states</span><span class="o">=</span><span class="n">state_geo</span><span class="p">)</span>
<span class="n">vis</span><span class="o">.</span><span class="n">update_map</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s">&#39;albersUsa&#39;</span><span class="p">)</span>
<span class="n">vis</span> <span class="o">+</span> <span class="p">([</span><span class="s">&#39;#c9cedb&#39;</span><span class="p">,</span> <span class="s">&#39;#0b0d11&#39;</span><span class="p">],</span> <span class="s">&#39;scales&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&#39;range&#39;</span><span class="p">)</span>
<span class="n">vis</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</pre></div>


<p><img alt="State Unemployment" src="http://farm9.staticflickr.com/8541/8695302818_4c83792642_z.jpg" /></p>
<p>Maps are a passion of mine- this is one area where I really want to make Vincent very strong, including the ability to easily add points, markers, etc. If you the reader have any features you would like to see with regarding to mapping, please post an issue on <a href="https://github.com/wrobstory/vincent/issues">Github</a></p>                </article>
                            </aside><!-- /#featured -->
                            <section id="content" class="body">
                    <h1>Other articles</h1>
                    <hr />
                    <ol id="posts-list" class="hfeed">
                                                

                 
                        <li><article class="hentry">    
                <header>
                    <h1><a href="../2013/04/quandl-pandas.html" rel="bookmark"
                           title="Permalink to Quandl and Pandas">Quandl and Pandas</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2013-04-27T00:00:00">
                Sat 27 April 2013
        </abbr>

                <address class="vcard author">
                By <a class="url fn" href="../author/rob-story.html">Rob Story</a>
        </address>
        <p>In <a href="../category/blog.html">Blog</a>. </p>
<p>tags: <a href="../tag/python.html">python</a><a href="../tag/pandas.html">pandas</a><a href="../tag/vincent.html">vincent</a><a href="../tag/data.html">data</a><a href="../tag/quandl.html">quandl</a></p>
</footer><!-- /.post-info -->                <p>The folks at <a href="http://www.quandl.com/">Quandl</a> have built a nice little <a href="http://www.quandl.com/help/python">python interface</a> for accessing their data and getting it into Pandas. My goal was to grab some data for all 50 states for a given date and get it into a DataFrame with the states as the index and different types ...</p>
                <a class="readmore" href="../2013/04/quandl-pandas.html">read more</a>
                                </div><!-- /.entry-content -->
            </article></li>
                            

                 
                        <li><article class="hentry">    
                <header>
                    <h1><a href="../2013/04/vega-axis-labeling.html" rel="bookmark"
                           title="Permalink to Vega Axis Labeling">Vega Axis Labeling</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2013-04-23T00:00:00">
                Tue 23 April 2013
        </abbr>

                <address class="vcard author">
                By <a class="url fn" href="../author/rob-story.html">Rob Story</a>
        </address>
        <p>In <a href="../category/blog.html">Blog</a>. </p>
<p>tags: <a href="../tag/vincent.html">vincent</a><a href="../tag/vega.html">vega</a><a href="../tag/javascript.html">javascript</a><a href="../tag/python.html">python</a><a href="../tag/pandas.html">pandas</a></p>
</footer><!-- /.post-info -->                <p>One of the things that took me a bit of time in learning <a href="https://github.com/trifacta/vega">Vega</a> was creating simple axis titles. Here is my current methodology for doing so: create custom data for each label, then reference the data with mark instances: </p>
<div class="codehilite"><pre>    <span class="s">&quot;data&quot;</span><span class="p">:</span> <span class="p">[</span>
       <span class="p">{</span><span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="s">&#39;x_label&#39;</span><span class="p">,</span> <span class="s">&#39;values&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s">&#39;label&#39;</span><span class="p">:</span> <span class="s">&#39;Time&#39;</span><span class="p">}]},</span>
       <span class="p">{</span><span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="s">&#39;y_label&#39;</span><span class="p">,</span> <span class="s">&#39;values&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s">&#39;label ...</span></pre></div>
                <a class="readmore" href="../2013/04/vega-axis-labeling.html">read more</a>
                                </div><!-- /.entry-content -->
            </article></li>
                            

                 
                        <li><article class="hentry">    
                <header>
                    <h1><a href="../2013/04/vincent-ipython.html" rel="bookmark"
                           title="Permalink to Vincent and iPython">Vincent and iPython</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2013-04-23T00:00:00">
                Tue 23 April 2013
        </abbr>

                <address class="vcard author">
                By <a class="url fn" href="../author/rob-story.html">Rob Story</a>
        </address>
        <p>In <a href="../category/blog.html">Blog</a>. </p>
<p>tags: <a href="../tag/python.html">python</a><a href="../tag/vincent.html">vincent</a><a href="../tag/data.html">data</a><a href="../tag/ipython.html">ipython</a></p>
</footer><!-- /.post-info -->                <p>Thanks to the work of <a href="https://twitter.com/healthyalgo">Abraham Flaxman</a><a href="https://github.com/aflaxman">(github)</a>, Vincent now supports iPython plotting, with just two additional lines of initialization required: </p>
<div class="codehilite"><pre><span class="kn">import</span> <span class="nn">vincent</span>
<span class="n">vincent</span><span class="o">.</span><span class="n">ipynb_init_d3</span><span class="p">()</span>
<span class="n">vincent</span><span class="o">.</span><span class="n">ipynb_init_vg</span><span class="p">()</span>

<span class="n">vis</span> <span class="o">=</span> <span class="n">vincent</span><span class="o">.</span><span class="n">Bar</span><span class="p">()</span>
<span class="n">vis</span><span class="o">.</span><span class="n">tabular_data</span><span class="p">(((</span><span class="s">&#39;A&#39;</span><span class="p">,</span> <span class="mi">28</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;B&#39;</span><span class="p">,</span> <span class="mi">55</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;C&#39;</span><span class="p">,</span> <span class="mi">43</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;D&#39;</span><span class="p">,</span> <span class="mi">91</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;E&#39;</span><span class="p">,</span> <span class="mi">81</span><span class="p">),</span> 
                  <span class="p">(</span><span class="s">&#39;F&#39;</span><span class="p">,</span> <span class="mi">53</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;G&#39;</span><span class="p">,</span> <span class="mi">19</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;H&#39;</span><span class="p">,</span> <span class="mi">87</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;I&#39;</span><span class="p">,</span> <span class="mi">52 ...</span></pre></div>
                <a class="readmore" href="../2013/04/vincent-ipython.html">read more</a>
                                </div><!-- /.entry-content -->
            </article></li>
                            

                 
                        <li><article class="hentry">    
                <header>
                    <h1><a href="../2013/04/pandas-vincent-timeseries.html" rel="bookmark"
                           title="Permalink to Plotting Time Series with Pandas DatetimeIndex and Vincent">Plotting Time Series with Pandas DatetimeIndex and Vincent</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2013-04-21T00:00:00">
                Sun 21 April 2013
        </abbr>

                <address class="vcard author">
                By <a class="url fn" href="../author/rob-story.html">Rob Story</a>
        </address>
        <p>In <a href="../category/blog.html">Blog</a>. </p>
<p>tags: <a href="../tag/python.html">python</a><a href="../tag/pandas.html">pandas</a><a href="../tag/vincent.html">vincent</a><a href="../tag/data.html">data</a></p>
</footer><!-- /.post-info -->                <p>The <a href="http://pandas.pydata.org/pandas-docs/dev/timeseries.html">Pandas Time Series/Date tools</a> and <a href="https://github.com/trifacta/vega">Vega</a> visualizations are a great match; Pandas does the heavy lifting of manipulating the data, and the Vega backend creates nicely formatted axes and plots. <a href="https://github.com/wrobstory/vincent">Vincent</a> is the glue that makes the two play nice, and provides a number of conveniences for making ...</p>
                <a class="readmore" href="../2013/04/pandas-vincent-timeseries.html">read more</a>
                                </div><!-- /.entry-content -->
            </article></li>
                            </ol><!-- /#posts-list -->
                            <p class="paginator">
        Page 1 / 2
            <a href="../category/blog2.html">&raquo;</a>
    </p>
                        </section><!-- /#content -->
                    <section id="extras" class="body">
                                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="http://wrobstory.github.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>
                            
                                                    <li><a href="http://twitter.com/oceankidbilly">twitter</a></li>
                                                    <li><a href="http://github.com/wrobstory">github</a></li>
                                                </ul>
                </div><!-- /.social -->
                </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-39972069-1']);
    _gaq.push(['_trackPageview']);
    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>
</body>
</html>