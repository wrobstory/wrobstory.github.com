<!DOCTYPE html>
<html lang="en">
  <head>
    <link href='http://fonts.googleapis.com/css?family=Noticia+Text:400,700' rel='stylesheet' type='text/css' />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title> Real world Pandas: Indexing and Plotting with the MultiIndex | wrobstory.github.com </title>

    <link rel="stylesheet" href="./theme/css/style.css" type="text/css" />
    <link rel="stylesheet" href="./theme/css/pygments.css" type="text/css" />
    <link rel="stylesheet" href="./theme/css/font-awesome.css" type="text/css"/>
  </head>
  <body>
    <div class=container>
                    
      <div class=navigation>
        <ul>
                      <li><a href="./index.html">Blog</a> </li>
                      <li><a href="./archives.html">Archive</a> </li>
                      <li><a href="./tags.html">Tags</a> </li>
                  </ul>
      </div>
      <div class=separator></div>                
        <div class=body>
            <h1 class="title"> Real world Pandas: Indexing and Plotting with the MultiIndex</h1>
    <p class=date> Wed 17 April 2013 </p>
    <p>The MultiIndex is one of the most valuable tools in the Pandas library, particularly if you are working with data that's heavy on columns and attributes. I was going to tackle Panels as well this time (as they can complement MultiIndexing in many ways), but the next version on Pandas that is on the cusp of release is about to introduce some new indexing tools that should make accessing minor and major axes in Panels better than before. Stay tuned. </p>
<p>Again using my data from the <a href="https://github.com/wrobstory/climatic/tree/master/examples">examples</a> folder in the climatic repo. </p>
<div class="highlight"><pre><span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">climatic</span> <span class="kn">as</span> <span class="nn">cl</span>

<span class="n">walsenburg</span> <span class="o">=</span> <span class="n">cl</span><span class="o">.</span><span class="n">MetMast</span><span class="p">()</span>
<span class="n">walsenburg</span><span class="o">.</span><span class="n">wind_import</span><span class="p">(</span><span class="s">r&#39;CO_Walsenburg_South_Data.txt&#39;</span><span class="p">,</span> 
                       <span class="n">header_row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">time_col</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> 
                       <span class="n">delimiter</span><span class="o">=</span><span class="s">&#39;</span><span class="se">\t</span><span class="s">&#39;</span><span class="p">,</span> <span class="n">smart_headers</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>


<p>Our dataframe is a little...busy: </p>
<div class="highlight"><pre><span class="o">&gt;&gt;&gt;</span><span class="n">df</span> <span class="o">=</span> <span class="n">walsenburg</span><span class="o">.</span><span class="n">data</span>
<span class="o">&gt;&gt;&gt;</span><span class="n">df</span>
<span class="o">&lt;</span><span class="k">class</span> <span class="nc">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="s">&#39;&gt;</span>
<span class="n">DatetimeIndex</span><span class="p">:</span> <span class="mi">106140</span> <span class="n">entries</span><span class="p">,</span> <span class="mi">2010</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mo">01</span> <span class="mi">14</span><span class="p">:</span><span class="mo">00</span><span class="p">:</span><span class="mo">00</span> <span class="n">to</span> <span class="mi">2012</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mo">07</span> <span class="mi">15</span><span class="p">:</span><span class="mi">50</span><span class="p">:</span><span class="mo">00</span>
<span class="n">Data</span> <span class="n">columns</span><span class="p">:</span>
<span class="p">(</span><span class="n">WS</span> <span class="n">Mean</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">)</span>      <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WS</span> <span class="n">StdDev</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">)</span>    <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WS</span> <span class="n">Max</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">)</span>       <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WS</span> <span class="n">Min</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">)</span>       <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WS</span> <span class="n">Mean</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">)</span>      <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WS</span> <span class="n">StdDev</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">)</span>    <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WS</span> <span class="n">Max</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">)</span>       <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WS</span> <span class="n">Min</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">)</span>       <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WS</span> <span class="n">Mean</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">)</span>      <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WS</span> <span class="n">StdDev</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">)</span>    <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WS</span> <span class="n">Max</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">)</span>       <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WS</span> <span class="n">Min</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">)</span>       <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WS</span> <span class="n">Mean</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">40.0</span><span class="p">)</span>      <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WS</span> <span class="n">StdDev</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">40.0</span><span class="p">)</span>    <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WS</span> <span class="n">Max</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">40.0</span><span class="p">)</span>       <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WS</span> <span class="n">Min</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">40.0</span><span class="p">)</span>       <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WD</span> <span class="n">Mean</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">49.0</span><span class="p">)</span>      <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WD</span> <span class="n">StdDev</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">49.0</span><span class="p">)</span>    <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WD</span> <span class="n">Max</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">49.0</span><span class="p">)</span>       <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WD</span> <span class="n">Min</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">49.0</span><span class="p">)</span>       <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WD</span> <span class="n">Mean</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">38.0</span><span class="p">)</span>      <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WD</span> <span class="n">StdDev</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">38.0</span><span class="p">)</span>    <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WD</span> <span class="n">Max</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">38.0</span><span class="p">)</span>       <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WD</span> <span class="n">Min</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">38.0</span><span class="p">)</span>       <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="n">dtypes</span><span class="p">:</span> <span class="n">float64</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span> <span class="n">int64</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
</pre></div>


<p>It would be really useful to be able to index the signals for each height. Since our columns are already tuples, Pandas lets us create a MultiIndex in one line and then apply it to our dataframe: </p>
<div class="highlight"><pre><span class="o">&gt;&gt;&gt;</span><span class="n">multi_cols</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;Signals&#39;</span><span class="p">,</span> <span class="s">&#39;Heights&#39;</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">multi_cols</span>
<span class="o">&gt;&gt;&gt;</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span>
<span class="n">MultiIndex</span>
<span class="p">[(</span><span class="n">WS</span> <span class="n">Mean</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">),</span> <span class="p">(</span><span class="n">WS</span> <span class="n">StdDev</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">),</span> <span class="p">(</span><span class="n">WS</span> <span class="n">Max</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">),</span> <span class="p">(</span><span class="n">WS</span> <span class="n">Min</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">),</span> 
 <span class="p">(</span><span class="n">WS</span> <span class="n">Mean</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">),</span> <span class="p">(</span><span class="n">WS</span> <span class="n">StdDev</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">),</span> <span class="p">(</span><span class="n">WS</span> <span class="n">Max</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">),</span> <span class="p">(</span><span class="n">WS</span> <span class="n">Min</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">),</span> 
 <span class="p">(</span><span class="n">WS</span> <span class="n">Mean</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">),</span> <span class="p">(</span><span class="n">WS</span> <span class="n">StdDev</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">),</span> <span class="p">(</span><span class="n">WS</span> <span class="n">Max</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">),</span> <span class="p">(</span><span class="n">WS</span> <span class="n">Min</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">),</span> 
 <span class="p">(</span><span class="n">WS</span> <span class="n">Mean</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">40.0</span><span class="p">),</span> <span class="p">(</span><span class="n">WS</span> <span class="n">StdDev</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">40.0</span><span class="p">),</span> <span class="p">(</span><span class="n">WS</span> <span class="n">Max</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">40.0</span><span class="p">),</span> <span class="p">(</span><span class="n">WS</span> <span class="n">Min</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">40.0</span><span class="p">),</span> 
 <span class="p">(</span><span class="n">WD</span> <span class="n">Mean</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">49.0</span><span class="p">),</span> <span class="p">(</span><span class="n">WD</span> <span class="n">StdDev</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">49.0</span><span class="p">),</span> <span class="p">(</span><span class="n">WD</span> <span class="n">Max</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">49.0</span><span class="p">),</span> <span class="p">(</span><span class="n">WD</span> <span class="n">Min</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">49.0</span><span class="p">),</span> 
 <span class="p">(</span><span class="n">WD</span> <span class="n">Mean</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">38.0</span><span class="p">),</span> <span class="p">(</span><span class="n">WD</span> <span class="n">StdDev</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">38.0</span><span class="p">),</span> <span class="p">(</span><span class="n">WD</span> <span class="n">Max</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">38.0</span><span class="p">),</span> <span class="p">(</span><span class="n">WD</span> <span class="n">Min</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">38.0</span><span class="p">)]</span>
</pre></div>


<p>Those columns still look busy- except now we can index by signal: </p>
<div class="highlight"><pre><span class="o">&gt;&gt;&gt;</span><span class="n">df</span><span class="p">[</span><span class="s">&#39;WS Mean 1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
                        <span class="mi">50</span>
<span class="n">Date</span> <span class="o">&amp;</span> <span class="n">Time</span> <span class="n">Stamp</span>         
<span class="mi">2010</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mo">01</span> <span class="mi">14</span><span class="p">:</span><span class="mo">00</span><span class="p">:</span><span class="mo">00</span>  <span class="mf">12.05</span>
<span class="mi">2010</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mo">01</span> <span class="mi">14</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="mo">00</span>  <span class="mf">11.48</span>
<span class="mi">2010</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mo">01</span> <span class="mi">14</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mo">00</span>  <span class="mf">14.19</span>
<span class="mi">2010</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mo">01</span> <span class="mi">14</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mo">00</span>  <span class="mf">13.21</span>
<span class="mi">2010</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mo">01</span> <span class="mi">14</span><span class="p">:</span><span class="mi">40</span><span class="p">:</span><span class="mo">00</span>  <span class="mf">11.92</span>
</pre></div>


<p>Nice! This is a little more useful, but it would be more helpful if our unique signals weren't at the top level, since the signals are grouped by height, rather than vice versa. Let's do a swap (this is why we named our levels in the previous step):</p>
<div class="highlight"><pre><span class="o">&gt;&gt;&gt;</span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">swaplevel</span><span class="p">(</span><span class="s">&#39;Signals&#39;</span><span class="p">,</span> <span class="s">&#39;Heights&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>


<p>Now we can conveniently index by height: </p>
<div class="highlight"><pre><span class="o">&gt;&gt;&gt;</span><span class="n">df</span><span class="p">[</span><span class="mf">50.0</span><span class="p">]</span>
<span class="o">&lt;</span><span class="k">class</span> <span class="nc">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="s">&#39;&gt;</span>
<span class="n">DatetimeIndex</span><span class="p">:</span> <span class="mi">106140</span> <span class="n">entries</span><span class="p">,</span> <span class="mi">2010</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mo">01</span> <span class="mi">14</span><span class="p">:</span><span class="mo">00</span><span class="p">:</span><span class="mo">00</span> <span class="n">to</span> <span class="mi">2012</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mo">07</span> <span class="mi">15</span><span class="p">:</span><span class="mi">50</span><span class="p">:</span><span class="mo">00</span>
<span class="n">Data</span> <span class="n">columns</span><span class="p">:</span>
<span class="n">WS</span> <span class="n">Mean</span> <span class="mi">1</span>      <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="n">WS</span> <span class="n">StdDev</span> <span class="mi">1</span>    <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="n">WS</span> <span class="n">Max</span> <span class="mi">1</span>       <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="n">WS</span> <span class="n">Min</span> <span class="mi">1</span>       <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="n">WS</span> <span class="n">Mean</span> <span class="mi">2</span>      <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="n">WS</span> <span class="n">StdDev</span> <span class="mi">2</span>    <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="n">WS</span> <span class="n">Max</span> <span class="mi">2</span>       <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="n">WS</span> <span class="n">Min</span> <span class="mi">2</span>       <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="n">dtypes</span><span class="p">:</span> <span class="n">float64</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
</pre></div>


<p>This is a lot more useful than having tuples for all of the columns. </p>
<p>The <a href="http://en.wikipedia.org/wiki/Wind_shear">wind shear</a> is a pretty common thing to calculate when doing wind data analysis, and for that calc we really just want mean wind speeds for each height. One option is to loop through the columns of our original dataframe and pull out the ones we need, then put the pieces back together with pd.concat: </p>
<div class="highlight"><pre><span class="o">&gt;&gt;&gt;</span><span class="n">df</span> <span class="o">=</span> <span class="n">walsenburg</span><span class="o">.</span><span class="n">data</span> <span class="c">#Back to our original dataframe</span>
<span class="o">&gt;&gt;&gt;</span><span class="n">series_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="o">&gt;&gt;&gt;</span><span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">iterkv</span><span class="p">():</span>
       <span class="k">if</span> <span class="s">&#39;WS Mean&#39;</span> <span class="ow">in</span> <span class="n">col</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
           <span class="c">#Create array levels so that the dataframe will build a MultiIndex</span>
           <span class="n">levels</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">col</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">col</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]])]</span>
           <span class="n">temp_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">col</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="n">levels</span><span class="p">)</span>
           <span class="n">series_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp_df</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">series_list</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c">#Put the pieces together</span>
<span class="o">&gt;&gt;&gt;</span><span class="n">df2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
                            <span class="mi">50</span>                    <span class="mi">30</span>         <span class="mi">40</span>
                     <span class="n">WS</span> <span class="n">Mean</span> <span class="mi">1</span>  <span class="n">WS</span> <span class="n">Mean</span> <span class="mi">2</span>  <span class="n">WS</span> <span class="n">Mean</span> <span class="mi">3</span>  <span class="n">WS</span> <span class="n">Mean</span> <span class="mi">4</span>
<span class="n">Date</span> <span class="o">&amp;</span> <span class="n">Time</span> <span class="n">Stamp</span>                                              
<span class="mi">2010</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mo">01</span> <span class="mi">14</span><span class="p">:</span><span class="mo">00</span><span class="p">:</span><span class="mo">00</span>      <span class="mf">12.05</span>      <span class="mf">12.26</span>      <span class="mf">11.38</span>      <span class="mf">11.70</span>
<span class="mi">2010</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mo">01</span> <span class="mi">14</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="mo">00</span>      <span class="mf">11.48</span>      <span class="mf">11.60</span>      <span class="mf">10.76</span>      <span class="mf">11.14</span>
<span class="mi">2010</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mo">01</span> <span class="mi">14</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mo">00</span>      <span class="mf">14.19</span>      <span class="mf">14.39</span>      <span class="mf">13.35</span>      <span class="mf">13.84</span>
<span class="mi">2010</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mo">01</span> <span class="mi">14</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mo">00</span>      <span class="mf">13.21</span>      <span class="mf">13.43</span>      <span class="mf">12.43</span>      <span class="mf">12.94</span>
<span class="mi">2010</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mo">01</span> <span class="mi">14</span><span class="p">:</span><span class="mi">40</span><span class="p">:</span><span class="mo">00</span>      <span class="mf">11.92</span>      <span class="mf">12.12</span>      <span class="mf">11.32</span>      <span class="mf">11.60</span>
</pre></div>


<p>Very nice! What if wanted to look at all of the signals, with column levels for height, signal (WS, WD, etc), and signal attribute (Mean, Max, etc)? Just a small tweak: </p>
<div class="highlight"><pre><span class="o">&gt;&gt;&gt;</span><span class="n">series_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="o">&gt;&gt;&gt;</span><span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">iterkv</span><span class="p">():</span>
       <span class="n">splitter</span> <span class="o">=</span> <span class="n">col</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
       <span class="n">signal</span> <span class="o">=</span> <span class="n">splitter</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
       <span class="n">att</span> <span class="o">=</span> <span class="s">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">splitter</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">splitter</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span>
       <span class="n">height</span> <span class="o">=</span> <span class="n">col</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
       <span class="n">levels</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">height</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">signal</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">att</span><span class="p">])]</span>
       <span class="n">temp_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">col</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="n">levels</span><span class="p">)</span>
       <span class="n">series_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp_df</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="n">df3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">series_list</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c">#Put the pieces together</span>
</pre></div>


<p>Now we can index with multiple keys to both height and signal: </p>
<div class="highlight"><pre><span class="o">&gt;&gt;&gt;</span><span class="n">df3</span><span class="p">[</span><span class="mi">50</span><span class="p">][</span><span class="s">&#39;WS&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span>
                         <span class="n">Mean</span> <span class="mi">1</span>  <span class="n">StdDev</span> <span class="mi">1</span>  <span class="n">Max</span> <span class="mi">1</span>  <span class="n">Min</span> <span class="mi">1</span>  <span class="n">Mean</span> <span class="mi">2</span>  <span class="n">StdDev</span> <span class="mi">2</span>  <span class="n">Max</span> <span class="mi">2</span>  <span class="n">Min</span> <span class="mi">2</span>
<span class="n">Date</span> <span class="o">&amp;</span> <span class="n">Time</span> <span class="n">Stamp</span>                                                                  
<span class="mi">2010</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mo">01</span> <span class="mi">14</span><span class="p">:</span><span class="mo">00</span><span class="p">:</span><span class="mo">00</span>      <span class="mf">12.05</span>      <span class="mf">2.14</span>  <span class="mf">15.90</span>   <span class="mf">7.91</span>   <span class="mf">12.26</span>      <span class="mf">2.25</span>  <span class="mf">16.30</span>   <span class="mf">7.94</span>
<span class="mi">2010</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mo">01</span> <span class="mi">14</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="mo">00</span>      <span class="mf">11.48</span>      <span class="mf">2.24</span>  <span class="mf">17.40</span>   <span class="mf">6.40</span>   <span class="mf">11.60</span>      <span class="mf">2.35</span>  <span class="mf">17.47</span>   <span class="mf">6.04</span>
<span class="mi">2010</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mo">01</span> <span class="mi">14</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mo">00</span>      <span class="mf">14.19</span>      <span class="mf">2.24</span>  <span class="mf">19.30</span>   <span class="mf">9.06</span>   <span class="mf">14.39</span>      <span class="mf">2.35</span>  <span class="mf">19.37</span>   <span class="mf">9.09</span>
<span class="mi">2010</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mo">01</span> <span class="mi">14</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mo">00</span>      <span class="mf">13.21</span>      <span class="mf">1.58</span>  <span class="mf">17.40</span>   <span class="mf">9.82</span>   <span class="mf">13.43</span>      <span class="mf">1.66</span>  <span class="mf">17.84</span>   <span class="mf">9.48</span>
<span class="mi">2010</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mo">01</span> <span class="mi">14</span><span class="p">:</span><span class="mi">40</span><span class="p">:</span><span class="mo">00</span>      <span class="mf">11.92</span>      <span class="mf">1.73</span>  <span class="mf">15.48</span>   <span class="mf">7.53</span>   <span class="mf">12.12</span>      <span class="mf">1.89</span>  <span class="mf">15.96</span>   <span class="mf">7.56</span>
<span class="mi">2010</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mo">01</span> <span class="mi">14</span><span class="p">:</span><span class="mi">50</span><span class="p">:</span><span class="mo">00</span>      <span class="mf">11.90</span>      <span class="mf">1.73</span>  <span class="mf">16.24</span>   <span class="mf">7.53</span>   <span class="mf">12.05</span>      <span class="mf">1.81</span>  <span class="mf">16.30</span>   <span class="mf">7.56</span>
<span class="mi">2010</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mo">01</span> <span class="mi">15</span><span class="p">:</span><span class="mo">00</span><span class="p">:</span><span class="mo">00</span>      <span class="mf">12.78</span>      <span class="mf">1.45</span>  <span class="mf">16.63</span>   <span class="mf">9.06</span>   <span class="mf">12.92</span>      <span class="mf">1.46</span>  <span class="mf">16.70</span>   <span class="mf">8.72</span>
<span class="mi">2010</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mo">01</span> <span class="mi">15</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="mo">00</span>      <span class="mf">13.27</span>      <span class="mf">1.65</span>  <span class="mf">18.15</span>   <span class="mf">9.44</span>   <span class="mf">13.40</span>      <span class="mf">1.73</span>  <span class="mf">18.22</span>   <span class="mf">9.48</span>
<span class="mi">2010</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mo">01</span> <span class="mi">15</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mo">00</span>      <span class="mf">14.05</span>      <span class="mf">1.80</span>  <span class="mf">18.15</span>   <span class="mf">9.82</span>   <span class="mf">14.24</span>      <span class="mf">1.81</span>  <span class="mf">18.62</span>   <span class="mf">9.86</span>
<span class="mi">2010</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mo">01</span> <span class="mi">15</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mo">00</span>      <span class="mf">13.32</span>      <span class="mf">1.80</span>  <span class="mf">19.66</span>   <span class="mf">9.06</span>   <span class="mf">13.48</span>      <span class="mf">1.81</span>  <span class="mf">19.74</span>   <span class="mf">9.09</span>

<span class="o">&gt;&gt;&gt;</span><span class="n">df3</span><span class="p">[</span><span class="mi">49</span><span class="p">][</span><span class="s">&#39;WD&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
                     <span class="n">Mean</span> <span class="mi">1</span>  <span class="n">StdDev</span> <span class="mi">1</span>  <span class="n">Max</span> <span class="mi">1</span>  <span class="n">Min</span> <span class="mi">1</span>
<span class="n">Date</span> <span class="o">&amp;</span> <span class="n">Time</span> <span class="n">Stamp</span>                                  
<span class="mi">2012</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mo">07</span> <span class="mi">15</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="mo">00</span>      <span class="mi">86</span>        <span class="mi">33</span>     <span class="mi">80</span>    <span class="mi">240</span>
<span class="mi">2012</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mo">07</span> <span class="mi">15</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mo">00</span>     <span class="mi">228</span>        <span class="mi">24</span>    <span class="mi">231</span>    <span class="mi">240</span>
<span class="mi">2012</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mo">07</span> <span class="mi">15</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mo">00</span>     <span class="mi">224</span>        <span class="mi">16</span>    <span class="mi">210</span>    <span class="mi">240</span>
<span class="mi">2012</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mo">07</span> <span class="mi">15</span><span class="p">:</span><span class="mi">40</span><span class="p">:</span><span class="mo">00</span>     <span class="mi">234</span>        <span class="mi">13</span>    <span class="mi">233</span>    <span class="mi">240</span>
<span class="mi">2012</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mo">07</span> <span class="mi">15</span><span class="p">:</span><span class="mi">50</span><span class="p">:</span><span class="mo">00</span>     <span class="mi">238</span>        <span class="mi">13</span>    <span class="mi">234</span>    <span class="mi">240</span>
</pre></div>


<p>We sorted levels earlier using level names- you can actually use integer indexing as well. Lets sort for signals at the top, then height, then attributes: </p>
<div class="highlight"><pre><span class="o">&gt;&gt;&gt;</span><span class="n">df3</span><span class="o">.</span><span class="n">reorder_levels</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="o">&lt;</span><span class="k">class</span> <span class="nc">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="s">&#39;&gt;</span>
<span class="n">DatetimeIndex</span><span class="p">:</span> <span class="mi">106140</span> <span class="n">entries</span><span class="p">,</span> <span class="mi">2010</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mo">01</span> <span class="mi">14</span><span class="p">:</span><span class="mo">00</span><span class="p">:</span><span class="mo">00</span> <span class="n">to</span> <span class="mi">2012</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mo">07</span> <span class="mi">15</span><span class="p">:</span><span class="mi">50</span><span class="p">:</span><span class="mo">00</span>
<span class="n">Data</span> <span class="n">columns</span><span class="p">:</span>
<span class="p">(</span><span class="n">WS</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">,</span> <span class="n">Mean</span> <span class="mi">1</span><span class="p">)</span>      <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WS</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">,</span> <span class="n">StdDev</span> <span class="mi">1</span><span class="p">)</span>    <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WS</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">,</span> <span class="n">Max</span> <span class="mi">1</span><span class="p">)</span>       <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WS</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">,</span> <span class="n">Min</span> <span class="mi">1</span><span class="p">)</span>       <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WS</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">,</span> <span class="n">Mean</span> <span class="mi">2</span><span class="p">)</span>      <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WS</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">,</span> <span class="n">StdDev</span> <span class="mi">2</span><span class="p">)</span>    <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WS</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">,</span> <span class="n">Max</span> <span class="mi">2</span><span class="p">)</span>       <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WS</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">,</span> <span class="n">Min</span> <span class="mi">2</span><span class="p">)</span>       <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WS</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="n">Mean</span> <span class="mi">3</span><span class="p">)</span>      <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WS</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="n">StdDev</span> <span class="mi">3</span><span class="p">)</span>    <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WS</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="n">Max</span> <span class="mi">3</span><span class="p">)</span>       <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WS</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="n">Min</span> <span class="mi">3</span><span class="p">)</span>       <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WS</span><span class="p">,</span> <span class="mf">40.0</span><span class="p">,</span> <span class="n">Mean</span> <span class="mi">4</span><span class="p">)</span>      <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WS</span><span class="p">,</span> <span class="mf">40.0</span><span class="p">,</span> <span class="n">StdDev</span> <span class="mi">4</span><span class="p">)</span>    <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WS</span><span class="p">,</span> <span class="mf">40.0</span><span class="p">,</span> <span class="n">Max</span> <span class="mi">4</span><span class="p">)</span>       <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WS</span><span class="p">,</span> <span class="mf">40.0</span><span class="p">,</span> <span class="n">Min</span> <span class="mi">4</span><span class="p">)</span>       <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WD</span><span class="p">,</span> <span class="mf">49.0</span><span class="p">,</span> <span class="n">Mean</span> <span class="mi">1</span><span class="p">)</span>      <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WD</span><span class="p">,</span> <span class="mf">49.0</span><span class="p">,</span> <span class="n">StdDev</span> <span class="mi">1</span><span class="p">)</span>    <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WD</span><span class="p">,</span> <span class="mf">49.0</span><span class="p">,</span> <span class="n">Max</span> <span class="mi">1</span><span class="p">)</span>       <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WD</span><span class="p">,</span> <span class="mf">49.0</span><span class="p">,</span> <span class="n">Min</span> <span class="mi">1</span><span class="p">)</span>       <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WD</span><span class="p">,</span> <span class="mf">38.0</span><span class="p">,</span> <span class="n">Mean</span> <span class="mi">2</span><span class="p">)</span>      <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WD</span><span class="p">,</span> <span class="mf">38.0</span><span class="p">,</span> <span class="n">StdDev</span> <span class="mi">2</span><span class="p">)</span>    <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WD</span><span class="p">,</span> <span class="mf">38.0</span><span class="p">,</span> <span class="n">Max</span> <span class="mi">2</span><span class="p">)</span>       <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="p">(</span><span class="n">WD</span><span class="p">,</span> <span class="mf">38.0</span><span class="p">,</span> <span class="n">Min</span> <span class="mi">2</span><span class="p">)</span>       <span class="mi">106140</span>  <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">values</span>
<span class="n">dtypes</span><span class="p">:</span> <span class="n">float64</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span> <span class="n">int64</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
</pre></div>


<p>If you are using tuples for your column or row names, I highly recommend building a MultiIndex out of them, as it allows for you to index and manipulate data very efficiently.</p>
<p>One last thing: I wrote a little library called <a href="https://github.com/wrobstory/vincent">Vincent</a> to plot data using <a href="http://trifacta.github.io/vega/">Vega</a>. Lets look at WS 1 vs WS 4 for the first ten days of data, passing our new MultiIndex to Vincent: </p>
<div class="highlight"><pre><span class="o">&gt;&gt;&gt;</span><span class="n">data</span> <span class="o">=</span> <span class="n">df3</span><span class="p">[</span><span class="s">&#39;2010-06-01&#39;</span><span class="p">:</span><span class="s">&#39;2010-06-11&#39;</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span><span class="kn">import</span> <span class="nn">vincent</span>
<span class="o">&gt;&gt;&gt;</span><span class="n">vis</span> <span class="o">=</span> <span class="n">vincent</span><span class="o">.</span><span class="n">Scatter</span><span class="p">()</span>
<span class="c">#Pass the levels as tuples</span>
<span class="o">&gt;&gt;&gt;</span><span class="n">vis</span><span class="o">.</span><span class="n">tabular_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[(</span><span class="mi">50</span><span class="p">,</span> <span class="s">&#39;WS&#39;</span><span class="p">,</span> <span class="s">&#39;Mean 1&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="s">&#39;WS&#39;</span><span class="p">,</span> <span class="s">&#39;Mean 4&#39;</span><span class="p">)])</span>
<span class="o">&gt;&gt;&gt;</span><span class="n">vis</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="s">r&#39;/vega.json&#39;</span><span class="p">,</span> <span class="n">split_data</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">html</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>


<p><img alt="Scatter 1" src="http://farm9.staticflickr.com/8111/8660124324_676b077dbe.jpg" /></p>
<p>It's a little...bloated, for lack of a better word. Let's remove fill and make the marks smaller: </p>
<div class="highlight"><pre><span class="o">&gt;&gt;&gt;</span><span class="n">vis</span> <span class="o">+</span> <span class="p">(</span><span class="s">&#39;transparent&#39;</span><span class="p">,</span> <span class="s">&#39;marks&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&#39;properties&#39;</span><span class="p">,</span> <span class="s">&#39;update&#39;</span><span class="p">,</span> <span class="s">&#39;fill&#39;</span><span class="p">,</span> <span class="s">&#39;value&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="n">vis</span> <span class="o">+</span> <span class="p">({</span><span class="s">&#39;value&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">},</span> <span class="s">&#39;marks&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&#39;properties&#39;</span><span class="p">,</span> <span class="s">&#39;update&#39;</span><span class="p">,</span> <span class="s">&#39;size&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="n">vis</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="s">r&#39;/vega.json&#39;</span><span class="p">,</span> <span class="n">split_data</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">html</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>


<p><img alt="Scatter 2" src="http://farm9.staticflickr.com/8121/8659022617_4698ca92ab.jpg" /></p>
<p>Better. Still need some axis labels, which is something I need to figure out how to do within Vega and make easy in Python. As always, thanks for reading!</p>
    
            <p class=tags>This entry was tagged as
            <a href="./tag/python.html">python</a>
            <a href="./tag/wind-data.html">wind data</a>
            <a href="./tag/pandas.html">pandas</a>
            <a href="./tag/.html"></a>
          </p>
        <div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'wrobstory'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>        </div>
        
                    <div class=footer>
  <p>&copy; Copyright <script language="JavaScript">var date = new Date(); document.write(date.getFullYear());</script> by Rob Story</p>
  <p> Powered by <a href="http://pypi.python.org/pypi/pelican/" target="_blank">Pelican</a>.  
    <a href="https://github.com/fjavieralba/flasky">Theme</a>  by <a href="http://fjavieralba.com">fjavieralba</a>
  </p> 
  <p>
    <div class=social style="font-size: 27px;">
      <ul>
        <script language="JavaScript">
          u = '';
          s = '';
          document.write('<a href=\"mailto:' + u + '@' + s + '\" target=\"_blank\">');
        </script>
            <li><i class="icon-envelope icon-large"></i> </li>
        </a>
        <a href="http://twitter.com/" target="_blank"> <li> <i class="icon-twitter-sign icon-large"> </li></i> </a>
        <a href=""><li><i class="icon-linkedin-sign icon-large" ></i></li></a>
        <a href="" target="_blank"> <li> <i class="icon-github-sign icon-large"></i> </li> </a>
        <a href="./feeds/all.rss.xml" rel="alternate" title="Recent Blog Posts"><li> <i class="icon-rss icon-large"></i> </li></a>
      </ul>
    </div>
  </p>
</div>            </div>
          </body>
</html>
